def detect_malware(alert):
    """
    Detect malware based on alert context,
    not only file hash.
    """

    description = alert.get("rule", {}).get("description", "").lower()
    full_text = str(alert).lower()

    malware_keywords = [
        "malware",
        "virus",
        "trojan",
        "ransom",
        "worm",
        "backdoor"
    ]

    for kw in malware_keywords:
        if kw in description or kw in full_text:
            return True, f"Malware keyword detected: {kw}"

    return False, None
